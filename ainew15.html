<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Virgi AI - Premium Chat Interface</title>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

    * {
        margin: 0; padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
    }

    body {
        background: linear-gradient(135deg, #030b18, #000000, #03121f);
        background-size: 300% 300%;
        animation: bgFlow 10s infinite alternate;
        color: white;
        min-height: 100vh;
        padding: 40px 0;
    }

    @keyframes bgFlow {
        0% { background-position: 0% 50%; }
        100% { background-position: 100% 50%; }
    }

    /* HEADER */
    .header {
        width: 100%;
        padding: 25px 40px;
        text-align: center;
        font-size: 40px;
        font-weight: 700;
        color: #00eaff;
        text-shadow: 0 0 25px #00eaff;
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255,255,255,0.15);
        background: rgba(255,255,255,0.02);
        letter-spacing: 2px;
        animation: fadeInDown 1.2s ease;
    }

    @keyframes fadeInDown {
        from { opacity: 0; transform: translateY(-25px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* MAIN CONTAINER (Tidak Full Screen) */
    .container {
        padding: 25px 40px;
        max-width: 900px;
        width: 90%;
        margin: 40px auto;
        display: flex;
        flex-direction: column;
        gap: 20px;

        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 25px;
        backdrop-filter: blur(15px);
        box-shadow: 0 0 25px rgba(0,234,255,0.15);
    }

    /* MODEL BAR */
    .model-bar {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
    }

    .model-option {
        padding: 14px 32px;
        border-radius: 30px;
        background: rgba(255,255,255,0.06);
        backdrop-filter: blur(14px);
        cursor: pointer;
        font-size: 18px;
        transition: 0.3s ease;
        border: 1px solid rgba(255,255,255,0.12);
    }

    .model-option:hover {
        background: rgba(0,234,255,0.25);
        transform: translateY(-4px);
        box-shadow: 0 0 18px #00eaff;
    }

    .model-option.active {
        background: #00eaff;
        color: #000;
        font-weight: 700;
        box-shadow: 0 0 20px #00eaff;
    }

    /* CHAT */
    .chat {
        max-height: 60vh;
        overflow-y: auto;
        padding: 25px;
        border-radius: 20px;
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.08);
        backdrop-filter: blur(16px);
    }

    .chat::-webkit-scrollbar {
        width: 12px;
    }
    .chat::-webkit-scrollbar-thumb {
        background: rgba(0,234,255,0.4);
        border-radius: 20px;
    }

    .bubble {
        max-width: 75%;
        padding: 16px 22px;
        margin: 18px 0;
        border-radius: 18px;
        font-size: 18px;
        line-height: 1.6;
        white-space: pre-wrap;
        animation: slideUp 0.4s ease;
    }

    @keyframes slideUp {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .user-bubble {
        background: linear-gradient(135deg, #00eaff, #0088aa);
        color: black;
        margin-left: auto;
        border-bottom-right-radius: 4px;
        box-shadow: 0 0 15px #00eaff;
    }

    .ai-bubble {
        background: rgba(255,255,255,0.15);
        border-bottom-left-radius: 4px;
        box-shadow: 0 0 15px rgba(0,234,255,0.2);
    }

    .loading {
        font-size: 18px;
        margin-top: 10px;
        color: #00eaff;
        animation: blink 1s infinite;
    }

    @keyframes blink {
        0% { opacity: 0.3; }
        100% { opacity: 1; }
    }

    /* INPUT AREA */
    .input-area {
        display: flex;
        gap: 15px;
    }

    #messageInput {
        flex: 1;
        padding: 18px;
        font-size: 18px;
        border-radius: 18px;
        border: none;
        outline: none;
        background: rgba(255,255,255,0.12);
        color: white;
        backdrop-filter: blur(12px);
    }

    #sendButton, #fileButton {
        padding: 16px 24px;
        border: none;
        border-radius: 18px;
        background: linear-gradient(135deg, #00eaff, #00bcd4);
        color: black;
        font-weight: 700;
        cursor: pointer;
        transition: 0.3s ease;
        font-size: 18px;
    }

    #sendButton:hover, #fileButton:hover {
        filter: brightness(1.2);
    }

    #fileInput { display: none; }
</style>
</head>

<body>

<div class="header">‚ö° VIRGI AI ‚Äì PREMIUM MODE</div>

<div class="container">

    <div class="model-bar">
        <div class="model-option active" data-model="model1">Grok Jail 1</div>
        <div class="model-option" data-model="model2">Grok Jail 2</div>
    </div>

    <div class="chat" id="chatMessages"></div>

    <div class="input-area">
        <button id="fileButton">üìÅ</button>
        <input type="file" id="fileInput">
        <input type="text" id="messageInput" placeholder="Ketik pesan...">
        <button id="sendButton">Kirim</button>
    </div>

</div>

<script>
let currentModel = "model1";
let uploadedFileBase64 = null;

/* SOUND */
const sendSound = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_8d6f7635e2.mp3?filename=click-124467.mp3");
const receiveSound = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_9b6f3c2c29.mp3?filename=notification-122477.mp3");

/* TTS SUARA PEREMPUAN */
function speak(text) {
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = "id-ID";
    utter.rate = 1.03;
    utter.pitch = 1.25;
    utter.volume = 1;

    let voices = speechSynthesis.getVoices();
    let femaleVoice = voices.find(v =>
        v.name.toLowerCase().includes("female") ||
        v.name.toLowerCase().includes("woman") ||
        v.name.toLowerCase().includes("wanita") ||
        (v.lang === "id-ID" && v.name.toLowerCase().includes("google"))
    );

    if (femaleVoice) utter.voice = femaleVoice;
    speechSynthesis.speak(utter);
}

speechSynthesis.onvoiceschanged = () => {};

/* API */
const apiMap = {
    model1: "https://darch-aichat.vercel.app/api/grok3jail1?text=",
    model2: "https://darch-aichat.vercel.app/api/grok3jail2?text=",
};

/* MODEL SELECT */
document.querySelectorAll(".model-option").forEach(btn => {
    btn.onclick = () => {
        document.querySelectorAll(".model-option").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentModel = btn.dataset.model;
    };
});

/* BUTTONS */
document.getElementById("sendButton").onclick = sendMessage;
document.getElementById("fileButton").onclick = () => document.getElementById("fileInput").click();
document.getElementById("messageInput").onkeypress = e => { if (e.key === "Enter") sendMessage(); };

/* FILE UPLOAD */
document.getElementById("fileInput").onchange = function() {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = evt => {
        uploadedFileBase64 = evt.target.result;
        addUserMessage("üìÑ File diupload: " + file.name);
    };
    reader.readAsDataURL(file);
};

/* SEND */
async function sendMessage() {
    const input = document.getElementById("messageInput");
    const text = input.value.trim();
    if (!text && !uploadedFileBase64) return;

    sendSound.currentTime = 0;
    sendSound.play();

    addUserMessage(text);
    input.value = "";

    const loadingId = addLoading();

    let payload = text;
    if (uploadedFileBase64) {
        payload += "\n\n[File Upload]\n" + uploadedFileBase64;
        uploadedFileBase64 = null;
    }

    try {
        const res = await fetch(apiMap[currentModel] + encodeURIComponent(payload));

        let cleanText = "";
        try {
            const json = await res.json();
            cleanText = json?.result?.text || "‚ö†Ô∏è API Error!";
        } catch {
            cleanText = await res.text();
        }

        removeLoading(loadingId);
        addAIMessage(cleanText);

        receiveSound.currentTime = 0;
        receiveSound.play();

        speak(cleanText);

    } catch {
        removeLoading(loadingId);
        addAIMessage("‚ö†Ô∏è Tidak dapat terhubung ke server!");
    }
}

/* UTIL */
function addUserMessage(text) {
    const chat = document.getElementById("chatMessages");
    chat.innerHTML += `<div class="bubble user-bubble">${text}</div>`;
    chat.scrollTop = chat.scrollHeight;
}

function addAIMessage(text) {
    const chat = document.getElementById("chatMessages");
    chat.innerHTML += `<div class="bubble ai-bubble">${text}</div>`;
    chat.scrollTop = chat.scrollHeight;
}

function addLoading() {
    const id = "loading-" + Date.now();
    document.getElementById("chatMessages").innerHTML += `<div id="${id}" class="loading">Virgi AI sedang mengetik...</div>`;
    return id;
}

function removeLoading(id) {
    const elem = document.getElementById(id);
    if (elem) elem.remove();
}
</script>

</body>
</html>